# 2 MySQL 索引原理和使用原则

## 2.1 索引  

维基百科对数据库索引的定义:
数据库索引, 是数据库管理系统 (DBMS) 中一个排序的数据结构, 以协助快速查询, 更新数据库表中的数据。

MongoDB对索引的定义:
索引是特殊的数据结构, 以有序和便于遍历的形式存储数据集合中的一个特定字段或一组字段的值。索引条目的排序支持有效的相等匹配和基于范围的查询操作。

理解:  
数据库表中的数据是以文件的形式存放在磁盘上的, 每一行数据都有他的磁盘地址。如果没有索引, 要从表中的数据检索出一条数据, 只能依次遍历整张表的数据, 直到找到这条数据。
索引是一种特殊的专门用来快速检索的数据结构。所以有了索引后, 只需要在索引里面去检索这条数据,找到数据存放在磁盘的地址后, 就可以找到数据了。

### 2.1.1 索引类型

**根据底层数据结构划分**
> 1. Hash 索引
> 2. B+Tree 索引

**根据索引字段个数划分**
> 1. 单值索引: 单个字段组成的索引
> 2. 复合索引: 多个字段组成的索引, 也叫做组合索引和多值索引

**根据是否在主键上建立的索引划分**  
> 1. 主键索引
> 2. 非主键索引: 也可以叫做辅助索引, 二级索引

**根据数据与索引的存储关联性划分**
> 1. 聚簇索引: 也叫做聚集索引, 索引的存储顺序和数据的存储顺序有关联。比如 InnoDB 中, 叶子节点存储的是既有索引也有数据, 而非叶子节点存储的是索引指针
> 2. 非聚簇索引: 也叫做非聚集索引, 索引的存储顺序和数据的存储顺序没有关联。 比如 MyISAM 中, 索引和数据文件分开存储, Inndob 里的辅助索引也是非聚簇索引

**索引的值是否可以重复划分**
> 1. 唯一索引: 索引的内容不能重复, 主键索引一般是特殊的唯一索引
> 2. 非唯一索引: 也叫做普通索引, 没有任何的限制

**其他的分类**
> 1. 全文索引: 针对比较大的数据的索引。


## 2.2 索引的演变

索引的实现基本是基于一种思想: 二分查找 (这班查找) 实现的。  
在一个已经排过序的数据中, 进行二娥分查找是一个很快的过程, 因为每次查找都能过滤到一半的数据。

### 2.2.1 数据结构实现 - 有序数组

数组的查找效率是非常快的。 特别是在有序数组的等值查询和比较查询效率非常的不错。
但是数组的更新却是一个弊端: 可能要挪动大量的数据（改变 index），所以只适合存储静态的数据

### 2.2.2 数据结构实现 - 链表
链表则可以支持频繁的修改和删除, 但是单链表的话, 查询效率不高, 同时指针还会占用一定的内存

### 2.2.3 数据结构实现 - 二叉查找树 (BST, Binary Search Tree)

二叉查找树 (二叉搜索树, 二叉排序树) 的特点
> 1. 若任意节点的左子树不空, 则左子树上所有结点的值均小于它的根结点的值
> 2. 若任意节点的右子树不空，则右子树上所有结点的值均大于它的根结点的值
> 3. 任意节点的左、右子树也分别为二叉查找
> 4. 没有键值相等的节点

二叉查找数可以实现快速查找, 又能实现快速插入。  
但是二叉树有一个问题: 它的查找耗时和这棵树的深度有关, 在最坏的情况下, 时间复杂度会退化为 O(n)。

假设现在想二叉查找树中插入 2, 3, 4, 5, 6。这个时候将会得到如下的一棵二叉查找树: 

![]

它会变成链表 （也叫做 "斜树"）, 这种情况下不能达到加快简书速度的目的, 和顺序查找效率差不多。

造成树倾斜的原因: 左右子树深度差太大, 导致不平衡。

### 2.2.4 数据结构实现 - 平衡二叉树 (AVL, Balanced Binary Search Tree)






## 参考
[MySQL索引分类，90%的开发都不知道](https://zhuanlan.zhihu.com/p/115746492)